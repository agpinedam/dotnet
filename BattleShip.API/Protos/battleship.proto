syntax = "proto3";

option csharp_namespace = "BattleShip.Protos";

package battleship;

service Game {
  rpc CreateGame (GrpcCreateGameRequest) returns (GrpcGameStatus);
  rpc Attack (GrpcAttackRequest) returns (GrpcGameStatus);
  rpc Undo (GrpcUndoRequest) returns (GrpcGameStatus);
}

message GrpcCreateGameRequest {
    int32 difficulty = 1;
}

message Empty {}

message GrpcAttackRequest {
    string gameId = 1;
    int32 row = 2;
    int32 col = 3;
}

message GrpcUndoRequest {
    string gameId = 1;
}

message GrpcMoveHistory {
    int32 turn = 1;
    string playerMove = 2;
    string playerResult = 3;
    string aiMove = 4;
    string aiResult = 5;
}

message GrpcGameStatus {
  string gameId = 1;
  repeated string playerGrid = 2; // Each string represents a row, e.g. "ABC..."
  repeated OpponentRow opponentGrid = 3;
  string winner = 4;
  bool isGameOver = 5;
  string lastAttackResult = 6;
  string lastAiAttackResult = 7;
  repeated GrpcMoveHistory history = 8;
}

message OpponentRow {
    repeated int32 values = 1; // 0 = null, 1 = hit (true), 2 = miss (false)
}
